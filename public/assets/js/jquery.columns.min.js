if(!window.console){var console={log:function(){}}}(function(b){b.fn.columns=function(d){var e=[];var c=Array.prototype.slice.call(arguments,1);if(typeof d==="string"){this.each(function(){var g=b.data(this,"columns");if(typeof g!=="undefined"&&b.isFunction(g[d])){var f=g[d].apply(g,c);if(f!==undefined&&f!==g){e.push(f)}}else{return b.error('No such method "'+d+'" for Columns')}})}else{this.each(function(){if(!b.data(this,"columns")){b.data(this,"columns",new a(this,d))}})}if(e.length===0){return this.data("columns")}else{if(e.length===1){return e[0]}else{return e}}};var a=function(d,c){this.$el=b(d);if(c){b.extend(this,c)}this.VERSION="2.2.2";this.sort=function(){var g=this;var f=/^(Jan|January|Feb|February|Mar|March|Apr|April|May|Jun|June|Jul|July|Aug|August|Sep|September|Oct|October|Nov|November|Dec|December|(0?\d{1})|(10|11|12))(-|\s|\/|\.)(0?[1-9]|(1|2)[0-9]|3(0|1))(-|\s|\/|\.|,\s)(19|20)?\d\d$/i;function e(i,h,j){h=(h)?-1:1;return function(l,k){l=l[i];k=k[i];if(f.test(l)&&f.test(k)){l=new Date(l);l=Date.parse(l);k=new Date(k);k=Date.parse(k)}else{if(typeof(j)!=="undefined"){l=j(l);k=j(k)}}if(l<k){return h*-1}if(l>k){return h*1}return 0}}if(g.total&&g.sortBy&&typeof g.data[0][g.sortBy]!=="undefined"){g.data.sort(e(g.sortBy,g.reverse))}};this.filter=function(){var g=this,f=g.searchableFields.length;if(g.query){var e=new RegExp(g.query,"gi");g.data=b.grep(g.data,function(i){for(var h=0;h<f;h++){if(typeof i[g.searchableFields[h]]==="string"){if(i[g.searchableFields[h]].match(e)){return true}}else{if(typeof i[g.searchableFields[h]]==="number"){if(i[g.searchableFields[h]]==g.query){return true}}}}return false})}g.total=g.data.length};this.paginate=function(){var e=this;e.pages=Math.ceil(e.data.length/e.size);e.page=(e.page<=e.pages?e.page:1);e.setRange();e.data=e.data.slice(e.range.start-1,e.range.end)};this.condition=function(){var i=this,g=[];if(i.schema){var e=i.data.length,j=i.schema.length;for(var m=0;m<e;m++){var h=i.data[m],l={};for(var k=0;k<j;k++){var f=i.schema[k];if(f.condition){if(!f.condition(h[f.key])){l=null;break}}l[f.key]=h[f.key]}if(l){g.push(l)}}i.data=g}};this.chevron=function(e,f){return Mustache.render(e,f)};this.create=function(){var i=this;i.resetData();if(i.searching){i.filter()}if(i.sorting){i.sort()}if(i.paginating){i.paginate()}function h(){i.thead=[];b.each(i.schema,function(l,k){if(!k.hide){var m={};if(b.inArray(k.key,i.sortableFields)===-1){m.notSortable=true}else{if(i.sortBy===k.key){if(i.reverse){m.sortedDown=true}else{m.sortedUp=true}}else{m.sortable=true}}m.key=k.key;m.header=k.header;i.thead.push(m)}})}function f(k,m){var l=[];if(k%2===0){l.push('<tr data-columns-row-id="'+k+'" class="'+i.evenRowClass+'">')}else{l.push('<tr data-columns-row-id="'+k+'" class="'+i.oddRowClass+'">')}b.each(i.schema,function(o,n){if(!n.hide){if(n.template){l.push("<td>"+i.chevron(n.template,m)+"</td>")}else{l.push("<td>"+m[n.key]+"</td>")}}});l.push("</tr>");return l}function j(){var k=[];k.push("<select>");b.each(i.showRows,function(l,n){var m='<option value="'+n+'"';if(n===i.size){m+='selected="selected"'}m+=">"+n+"</option>";k.push(m)});k.push("</select>");i.showRowsMenu=k.join("")}function g(){i.rows=[];if(i.total){b.each(i.data,function(k,l){if(k===0){h()}i.rows.push(f(k,l).join(""))})}else{i.rows.push('<tr class="'+i.evenRowClass+'"><td colspan="'+i.schema.length+'"><em>No Results</em></td>')}}g();j();var e={prevPage:i.page-1,nextPage:i.page+1,prevPageExists:i.pageExists(i.page-1),nextPageExists:i.pageExists(i.page+1),resultRange:i.range,tableTotal:i.total,showRowsMenu:i.showRowsMenu,rows:i.rows,headers:i.thead,query:i.query,search:i.search,table:i.table};b.extend(i.view,e);if(i.plugins){b.each(i.plugins,function(k,l){if(typeof ColumnsPlugins!=="undefined"){if(typeof ColumnsPlugins[l]!=="undefined"){ColumnsPlugins[l].create.call(i)}}})}if(i.search){i.$el.html(i.chevron(i.template,i.view));i.search=false}else{b("[data-columns-table]",i.$el).remove();i.$el.append(i.chevron(i.template,i.view))}return true};this.init=function(){var i=this;function f(){i.schema=[];b.each(i.data[0],function(j){i.schema.push({header:j,key:j})})}function g(){i.searchableFields=[];b.each(i.data[0],function(j){i.searchableFields.push(j)})}function h(){i.sortableFields=[];b.each(i.data[0],function(j){i.sortableFields.push(j)})}function e(){b.ajax({url:i.templateFile,async:false,success:function(j){i.template=j},error:function(){b.error("Template could not be found.")}})}if(b.isArray(i.data)){i.master=[];i.view={};i.$el.addClass("columns");i.$el.on("click",".ui-table-sortable",function(j){var k=b(this).data("columns-sortby");if(i.sortBy===k){i.reverse=(i.reverse)?false:true}i.sortBy=k;i.sortHandler(j)});i.$el.on("click",".ui-table-control-next, .ui-table-control-prev",function(j){i.page=b(this).data("columns-page");i.pageHandler(j)});i.$el.on("keyup",".ui-table-search",function(j){i.query=b(this).val();i.searchHandler(j)});i.$el.on("change",".ui-table-size select",function(j){i.size=parseInt(b(this).val());i.sizeHandler(j)});if(i.plugins){b.each(i.plugins,function(j,k){if(typeof ColumnsPlugins!=="undefined"){if(typeof ColumnsPlugins[k]!=="undefined"){ColumnsPlugins[k].init.call(i)}}})}if(i.conditioning){i.condition()}if(!i.schema){f()}if(!i.searchableFields){g()}if(!i.sortableFields){h()}if(i.templateFile){e()}b.extend(i.master,i.data);i.create()}else{b.error('The "data" parameter must be an array.')}};this.init()};a.prototype={evenRowClass:"ui-table-rows-even",oddRowClass:"ui-table-rows-odd",liveSearch:true,page:1,pages:1,plugins:null,query:null,reverse:false,pagination:true,schema:null,search:true,searchableFields:null,showRows:[5,10,25,50],size:5,sortableFields:null,sortBy:null,table:true,templateFile:null,template:'<!-- Search Box: Only rendered while search is true --> {{#search}} <div class="ui-columns-search"> <input class="ui-table-search" placeholder="検索" type="text" name="query" data-columns-search="true" value="{{query}}" /> </div> {{/search}} <!-- Search Box: Only rendered while search is true --> <!-- Columns Table: Only rendered while table is true --> {{#table}} <div class="ui-columns-table" data-columns-table="true"> <table class="ui-table"> <!-- Columns Table Head: Headers have 4 possible states (sortable, notSortable, sortedUp, sortedDown) --> <thead> {{#headers}} {{#sortable}} <th class="ui-table-sortable" data-columns-sortby="{{key}}">{{header}}</th> {{/sortable}} {{#notSortable}} <th class="">{{header}}</th> {{/notSortable}} {{#sortedUp}} <th class="ui-table-sort-up ui-table-sortable" data-columns-sortby="{{key}}">{{header}} <span class="ui-arrow">&#x25B2;</span></th> {{/sortedUp}} {{#sortedDown}} <th class="ui-table-sort-down ui-table-sortable" data-columns-sortby="{{key}}">{{header}} <span class="ui-arrow">&#x25BC;</span></th> {{/sortedDown}} {{/headers}} </thead> <!-- Columns Table Head: Headers have 4 possible states (sortable, notSortable, sortedUp, sortedDown) --> <!-- Columns Table Body: Table columns are rendered outside of this template  --> <tbody> {{#rows}} {{{.}}} {{/rows}} </tbody> <!-- Columns Table Body: Table columns are rendered outside of this template  --> </table> <!-- Columns Controls  --> <div class="ui-table-footer"> <span class="ui-table-size">Show rows: {{{showRowsMenu}}}</span> <span class="ui-table-results">Results: <strong>{{resultRange.start}} &ndash; {{resultRange.end}}</strong> of <strong>{{tableTotal}}</strong> </span> <span class="ui-table-controls"> {{#prevPageExists}} <span class="ui-table-control-prev" data-columns-page="{{prevPage}}"> <img src="images/arrow-left.png"> </span> {{/prevPageExists}} {{^prevPageExists}} <span class="ui-table-control-disabled"> <img src="images/arrow-left.png"> </span> {{/prevPageExists}} {{#nextPageExists}} <span class="ui-table-control-next" data-columns-page="{{nextPage}}"> <img src="images/arrow-right.png"> </span> {{/nextPageExists}} {{^nextPageExists}} <span class="ui-table-control-disabled"> <img src="images/arrow-right.png"> </span> {{/nextPageExists}} </span> </div> <!-- Columns Controls  --> </div> {{/table}} <!-- Columns Table: Only rendered while table is true -->',conditioning:true,paginating:true,searching:true,sorting:true,pageHandler:function(){this.create()},searchHandler:function(c){if(this.liveSearch){this.create()}else{if(c.keyCode=="13"){this.create()}}},sizeHandler:function(){this.create()},sortHandler:function(){this.page=1;this.create()},destroy:function(){this.$el.data("columns",null);this.$el.empty();return true},getObject:function(){return this},getPage:function(){return this.page},getQuery:function(){return this.query},getRange:function(){return this.range},getRows:function(){return this.rows},getShowRowsMenu:function(){return this.showRowsMenu},getTemplate:function(){return this.template},getThead:function(){return this.thead},getTotal:function(){return this.total},getVersion:function(){return this.VERSION},getView:function(){return this.view},gotoPage:function(c){if(this.pageExists(c)){this.page=c;this.create();return true}return false},pageExists:function(c){return(c>0&&c<=this.pages)?true:false},resetData:function(c){this.data=this.master.slice(0);return this.data},setMaster:function(c){if(b.isArray(c)){this.master=c;return true}return false},setPage:function(c){this.page=(this.pageExists(c)?c:this.page);return this.page},setRange:function(){var d=((this.page-1)*(this.size));var c=(d+this.size<this.total)?d+this.size:this.total;this.range={start:d+1,end:c}},setTotal:function(c){this.total=c;return true},startTime:null,endTime:null,startTimer:function(){var c=new Date();this.startTime=c.getTime()},endTimer:function(){var c=new Date();this.endTime=c.getTime()},getTimer:function(){console.log((this.endTime-this.startTime)/1000)}}})(jQuery);